<!--
@file: docs/Diary.md
@description: Дневник наблюдений, решений и проблем проекта
@dependencies: docs/Project.md, docs/tasktracker.md, docs/qa.md
@created: 2025-08-19
-->

### 2025-08-19
**Наблюдения**
- Исходный MU-плагин оформлен как обычный плагин с классами `Postman_Admin`, `Postman_Generator`, `Postman_Options`, `Postman_Routes`.
- Присутствуют базовые меры безопасности: `ABSPATH`-guard, `manage_options`, `check_admin_referer`.
- Часть HTML-вывода в админке требует системного экранирования для соответствия WPCS/PCP.

**Решения**
- Оформить отдельный плагин `mksddn-postman-collection` для публикации в WordPress.org, документацию хранить в `docs/` в корне GitHub.
- Включить i18n, обновить заголовки плагина, подготовить readme для каталога.
- Настроить PHPCS и PCP в CI.

**Проблемы**
- Не подтверждены минимальные версии PHP/WP, лицензия, `text-domain` и `slug` для каталога. Вынесено в `docs/qa.md`.

### 2025-08-19
**Наблюдения**
- Заменили `json_encode` на `wp_json_encode` и включили строгие сравнения в `in_array()`.
- Исправлена синтаксическая ошибка в `class-postman-admin.php`.

**Решения**
- Добавлен фильтр `mksddn_postman_capability` для гибкого контроля доступа.
- Добавлена команда WP-CLI для экспорта коллекции.

**Проблемы**
- Требуется локальный прогон PCP, чтобы убедиться в отсутствии скрытых нарушений.

### 2025-01-27
**Наблюдения**
- Обнаружена проблема: в Postman коллекцию добавлялась папка "Options Pages" даже когда в админке WordPress нет реальных options pages (только example-* страницы).
- Проблема была в методе `Postman_Routes::get_options_routes()`, который всегда добавлял "List of Options Pages" запрос, даже если все найденные страницы были example-*.

**Решения**
- Изменена логика в `get_options_routes()`: теперь сначала проверяется наличие реальных страниц (не example-*), и только при их наличии добавляется "List of Options Pages" запрос.
- Добавлена переменная `$has_real_pages` для отслеживания наличия реальных страниц.
- Использован `array_unshift()` для добавления списка в начало массива.

**Проблемы**
- Нет критических проблем. Исправление протестировано и работает корректно.


